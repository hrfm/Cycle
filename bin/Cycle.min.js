var __extends=this.__extends||function(t,i){function n(){this.constructor=t}for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e]);n.prototype=i.prototype,t.prototype=new n},hrfm;!function(t){var i=function(){function t(i,n,e){void 0===n&&(n=void 0),void 0===e&&(e=0),this.id=t._ID++,this._f=i,this._s=n,this.priority=e}return t.prototype.e=function(t){return void 0===t&&(t=null),0==this._f.call(this._s,t)?null:this.n},t.prototype.eq=function(t,i){return void 0===i&&(i=void 0),t==this._f&&i==this._s},t._ID=0,t}();t.Closure=i;var n=function(){function t(){}return t.prototype.add=function(t,n,e){void 0===n&&(n=void 0),void 0===e&&(e=0);var o,s,r;if(this.head){for(o=this.head,r=null;o;){if(o.eq(t,n))return-1;!r&&o.priority<e&&(r=o),o=o.n}o=new i(t,n,e),r?r.p?(s=r.p,r.p=o,o.n=r,o.p=s,s.n=o):(r.p=o,o.n=r,this.head=o):(r=this.tail,r.n=o,o.p=r,this.tail=o)}else o=new i(t,n,e),this.head=this.tail=o;return o.id},t.prototype.rm=function(t,i){void 0===i&&(i=void 0);for(var n=this.head;n;){if(n.eq(t,i))return this._rm(n),void(n=null);n=n.n}},t.prototype.rmById=function(t){for(var i=this.head;i;){if(i.id==t)return this._rm(i),void(i=null);i=i.n}},t.prototype.rmAll=function(){for(var t,i=this.head;i;)t=i.n,i=null,i=t;this.head=null,this.tail=null},t.prototype.exec=function(t){if(void 0===t&&(t=void 0),this.head){var i=this.head;if("undefined"==typeof t)for(;i;)i=i.e();else for(;i;)i=i.e(t)}},t.prototype._rm=function(t){if(this.head==t){if(this.tail==t)return this.head=null,void(this.tail=null);this.head=t.n,t.n.p=null}else this.tail==t?(this.tail=t.p,t.p.n=null):(t.p.n=t.n,t.n.p=t.p)},t}();t.ClosureList=n;var e=function(){function t(){this._hash_=[]}return t.prototype.on=function(t,i,e,o){void 0===e&&(e=this),void 0===o&&(o=0);var s,r,a=t.split(" "),h=a.length;for(s=0;h>s;s++)r=a[s],this._hash_[r]||(this._hash_[r]=new n),this._hash_[r].add(i,e,o);return this},t.prototype.onWithId=function(t,i,e,o){return void 0===e&&(e=this),void 0===o&&(o=0),this._hash_[t]||(this._hash_[t]=new n),this._hash_[t].add(i,e,o)},t.prototype.off=function(t,i,n){if(void 0===i&&(i=void 0),void 0===n&&(n=this),"number"==typeof t)for(var e in this._hash_)this._hash_[e].rmById(t);else if("string"==typeof t){var o,s,r=t.split(" "),a=r.length;for(o=0;a>o;o++)s=r[o],this._hash_[s]&&("undefined"==typeof i?this._hash_[s].rmAll():this._hash_[s].rm(i,n))}return this},t.prototype.execute=function(t,i){void 0===i&&(i=null),this._hash_[t]&&this._hash_[t].exec(i)},t.prototype.removeAllListeners=function(){for(var t in this._hash_)this._hash_[t].rmAll();this._hash_=[]},t}();t.EventDispatcher=e}(hrfm||(hrfm={}));var Cycle=function(t){function i(i){void 0===i&&(i=0),t.call(this),this.running=!1,this.interval=i,this.initialTime=(new Date).getTime(),this.elapsedTime=0,this._requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return setTimeout(t,17)},this._cancelAnimationFrame=window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout}return __extends(i,t),i.prototype.start=function(){if(1!=this.running){var t=this,i=0,n=(new Date).getTime(),e=0,o=this.interval;this._onAnimate=o>0?function(){if(i=(new Date).getTime(),i-n>100*o&&(n=i-o),e=i-n,e>o){var s=~~(e/o);n+=s*o,t.execute("cycle",s)}t.elapsedTime+=e,t._animateID=t._requestAnimationFrame.call(window,t._onAnimate)}:function(){i=(new Date).getTime(),e=i-n,t.elapsedTime+=e,t.execute("cycle",1),n=i,t._animateID=t._requestAnimationFrame.call(window,t._onAnimate)},this._animateID=this._requestAnimationFrame.call(window,t._onAnimate),this.running=!0,this.execute("start")}},i.prototype.stop=function(){0!=this.running&&(this._onAnimate=function(){},this._cancelAnimationFrame.call(window,this._animateID),this.running=!1,this.execute("stop"))},i}(hrfm.EventDispatcher);